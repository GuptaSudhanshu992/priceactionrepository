function handleCredentialResponse(response){alert("callback handled");console.log("Encoded JWT ID token: "+response.credential);const button=document.getElementById('gloginbtn');const referrer=isReferrerFromCurrentDomain(document.referrer)?document.referrer:window.location.origin;const response_message=document.getElementById('response_messages');const id_token=response.credential;const auth_method='Google';response_message.innerHTML="";response_message.style.display="none";response_message.classList.remove('alert-success');response_message.classList.remove('alert-danger');button.disabled=true;button.className='btn btn-success btn-block';button.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>';try{const response=await fetch("/members/socialaccountlogin/",{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded','X-CSRFToken':csrfToken},body:new URLSearchParams({id_token:id_token,auth_method:auth_method,referrer:referrer})});const data=await response.json();if(data.success){response_message.innerHTML=data.message;response_message.style.display="block";response_message.classList.add('alert-success');setTimeout(()=>{window.location.href=data.redirect_url;},3000);}else{console.log('Login attempt failed!');button.disabled=false;button.innerHTML='Login';response_message.innerHTML=data.message;response_message.style.display="block";response_message.classList.add('alert-danger');}}catch(error){console.error('Request error:',error);button.disabled=false;button.innerHTML='Login';response_message.innerHTML='Unexpected error has occurred, please refresh the page and try again...';response_message.style.display="block";response_message.classList.add('alert-danger');}}
window.onload=function(){google.accounts.id.initialize({client_id:"742784578451-kkps59hdh9fn38k47rtlomadklghd9pi.apps.googleusercontent.com",callback:handleCredentialResponse});google.accounts.id.prompt();};